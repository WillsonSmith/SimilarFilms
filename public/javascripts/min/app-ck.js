picturefill(),function t(){function t(){function t(t){for(var e,i=0,a=r.length;a>i;i++){e=r[i].getAttribute("data-film");for(var l=0,s=t.results.length;s>l;l++)e===t.results[l]&&(r[i].querySelector(".icon-heart").classList.remove("hidden"),r[i].querySelector(".icon-heart2").classList.add("hidden"))}}function e(t){function e(t){t.querySelector(".icon-heart").classList.toggle("hidden"),t.querySelector(".icon-heart2").classList.toggle("hidden")}function r(t,e,r,a){i.results.push(t),i.extraData[t]={title:t,id:e,rating:r,posterURL:a}}var a=this.getAttribute("data-film"),l=this.getAttribute("data-id"),s=this.getAttribute("data-rating"),n=this.getAttribute("data-image"),o;null!=i&&(o=i.results.indexOf(a)),null!=o&&-1!==o?(i.results.splice(o,1),delete i.extraData[a],localforage.setItem("favourites",i,function(){e(this)}.bind(this))):null==i?(i={results:[],extraData:{}},r(a,l,s,n),localforage.setItem("favourites",i,function(t){e(this)}.bind(this))):(r(a,l,s,n),localforage.setItem("favourites",i,function(t){e(this)}.bind(this)))}for(var i,r=document.querySelectorAll(".result"),a=0,l=r.length;l>a;a++)r[a].querySelector(".fav").addEventListener("click",e);localforage.getItem("favourites").then(function(e){i=e,t(i)})}t()}();